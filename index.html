<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>카메라로 비율 측정해서 유사한 연예인 추천해주기</title>

  <style>
    :root{
      --bg:#0b0f14;
      --card:#121826;
      --muted:#8aa0b5;
      --text:#eaf2ff;
      --primary:#5ad1ff;
      --border:rgba(255,255,255,.08);
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:ui-sans-serif,system-ui,Apple SD Gothic Neo,Segoe UI;
      background:var(--bg); color:var(--text);
    }
    .screen{display:none; min-height:100vh; padding:20px;}
    .screen.active{display:block;}
    .top{max-width:1100px; margin:0 auto 16px;}
    h1{margin:0 0 6px; font-size:22px;}
    .sub{margin:0; color:var(--muted); font-size:14px;}

    .panel{
      max-width:1100px; margin:0 auto;
      background:var(--card); border:1px solid var(--border);
      border-radius:16px; padding:16px;
    }
    .btnRow{display:flex; gap:10px; flex-wrap:wrap;}
    .btn{
      border:1px solid var(--border);
      background:#0f1522; color:var(--text);
      padding:12px 14px; border-radius:12px;
      cursor:pointer; font-weight:900;
    }
    .btn.primary{background:rgba(90,209,255,.12); border-color:rgba(90,209,255,.35);}
    .btn.ghost{background:transparent;}
    .hint{color:var(--muted); margin:12px 0 0; font-size:13px;}

    .layout{
      max-width:1100px; margin:0 auto;
      display:grid; grid-template-columns: 1.2fr .8fr;
      gap:14px;
    }
    @media (max-width: 900px){
      .layout{grid-template-columns: 1fr;}
    }

    .videoWrap{
      position:relative; background:var(--card);
      border:1px solid var(--border); border-radius:16px;
      overflow:hidden; min-height:320px;
    }
    video,canvas{width:100%; height:auto; display:block;}
    #overlay{position:absolute; inset:0; width:100%; height:100%;}

    /* 거울모드: 전면(user)일 때만 JS가 class로 켬 */
    .mirrored{
      transform: scaleX(-1);
      transform-origin: center;
    }

    .status{
      position:absolute; left:12px; bottom:12px;
      background:rgba(0,0,0,.45); border:1px solid var(--border);
      padding:8px 10px; border-radius:12px; font-size:13px;
    }

    /* ✅ 카운트다운 큰 숫자 */
    .countdown{
      position:absolute; inset:0;
      display:flex; align-items:center; justify-content:center;
      font-size:72px; font-weight:1000;
      background:rgba(0,0,0,.25);
      opacity:0; pointer-events:none;
      transition:opacity .12s ease;
    }
    .countdown.show{opacity:1;}

    .resultWrap{
      background:var(--card); border:1px solid var(--border);
      border-radius:16px; padding:16px;
    }
    .headline{margin:0 0 12px; font-size:18px;}
    .card{
      border:1px solid var(--border); border-radius:16px;
      overflow:hidden; background:#0f1522;
    }
    .card img{width:100%; height:320px; object-fit:cover; display:block;}
    .meta{padding:10px 12px;}
    .name{font-weight:950; font-size:16px;}
    .detail{color:var(--muted); font-size:13px; margin-top:4px;}

    .scoreBox{
      max-width:1100px; margin:0 auto;
      display:flex; align-items:center; gap:10px;
      background:var(--card); border:1px solid var(--border);
      border-radius:16px; padding:12px 14px;
    }
    .scoreLabel{color:var(--muted); font-size:13px;}
    .score{font-size:22px; font-weight:1000;}
  </style>
</head>

<body>
  <!-- HOME -->
  <main id="screen-home" class="screen active">
    <header class="top">
      <h1>카메라로 비율 측정해서 유사한 연예인 추천해주기</h1>
      <p class="sub">정면 전신(머리~발끝)이 화면에 들어오게 맞춘 다음, 촬영하기를 눌러줘.</p>
    </header>

    <section class="panel">
      <div class="btnRow">
        <button id="btnMale" class="btn primary">측정하기 남자</button>
        <button id="btnFemale" class="btn">측정하기 여자</button>
      </div>
      <p class="hint">카메라는 HTTPS(또는 localhost)에서만 동작합니다.</p>
    </section>
  </main>

  <!-- A 화면 -->
  <main id="screen-a" class="screen">
    <header class="top">
      <div class="scoreBox">
        <div class="scoreLabel">측정 점수</div>
        <div id="score" class="score">-</div>
      </div>
    </header>

    <section class="layout">
      <div class="videoWrap">
        <video id="video" playsinline autoplay muted></video>
        <canvas id="overlay"></canvas>
        <div id="countdown" class="countdown">3</div>
        <div id="status" class="status">대기중…</div>
      </div>

      <div class="resultWrap">
        <h2 class="headline">너와 커플로 가장 잘 어울리는 사람은</h2>
        <div class="card">
          <img id="pickImg" alt="추천 이미지" />
          <div class="meta">
            <div id="pickName" class="name">-</div>
            <div id="detail" class="detail">촬영하기 버튼을 눌러 측정해줘.</div>
          </div>
        </div>

        <div class="btnRow">
          <button id="btnCapture" class="btn primary">촬영하기 (3초)</button>
          <button id="btnSwitchCamera" class="btn">전면/후면 전환</button>
          <button id="btnRetry" class="btn">다시 측정</button>
          <button id="btnBack" class="btn ghost">홈으로</button>
        </div>

        <p class="hint" style="margin-top:12px;">
          촬영 버튼을 누르면 3초 후 사진 1장으로만 측정합니다.
        </p>
      </div>
    </section>
  </main>

  <!-- MediaPipe Pose (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.js"></script>

  <script src="./app.js?v=12"></script>
</body>
</html>
